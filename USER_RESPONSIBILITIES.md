### Зоны ответственности пользователя

`pg-bash-exporter` является исполнителем команд, описанных в конфигурации. Ответственность за безопасность и корректность этих команд лежит на пользователе.

#### I. Безопасность

1.  **Контроль доступа к `config.yaml`:**
    Предоставление прав на запись в конфигурационный файл равносильно предоставлению прав на выполнение команд от имени процесса экспортера.

2.  **Использование команд только для чтения:**
    Команды, определенные в конфигурации, не должны изменять состояние системы. Экспортер предназначен только для сбора данных.

3.  **Кардинальность меток:**
    Не следует использовать в качестве значений для `labels` данные с высокой кардинальностью (например, уникальные ID, email, временные метки), так как это может привести к проблемам с производительностью Prometheus.

#### II. Корректность данных

4.  **Соблюдение типов метрик Prometheus:**
    Тип `counter` следует использовать только для монотонно возрастающих значений. Для остальных значений (например, нагрузка CPU, количество процессов) следует использовать `gauge`.

5.  **Использование `dynamic_labels` для многострочного вывода:**
    Если команда возвращает несколько строк, необходимо использовать `dynamic_labels` для обеспечения уникальности каждой метрики и предотвращения ошибок в Prometheus.

6.  **Формат вывода команд:**
    Для надежного парсинга вывод команд должен быть простым и стабильным (например, колонки, разделенные пробелами).

#### III. Стабильность работы

7.  **Настройка таймаутов:**
    Таймаут выполнения команды в `config.yaml` должен быть меньше, чем `scrape_timeout` в конфигурации Prometheus, чтобы избежать преждевременного завершения запроса.

8.  **Валидация конфигурации:**
    Перед применением изменений на работающем сервере рекомендуется проверять синтаксис `config.yaml` с помощью флага `--validate-config`.

9.  **Производительность команд:**
    Перед добавлением команды в конфигурацию следует оценить время ее выполнения. Для длительных операций рекомендуется использовать кэширование (`cache_ttl`).